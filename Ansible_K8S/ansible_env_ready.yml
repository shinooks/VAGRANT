---
- name: Setup for the Ansible's Environment
  hosts: localhost
  gather_facts: no
  # tasks는 hosts(노드 그룹 등)를 대상으로 name으로 구분된 작업을 순차적으로 수행
  tasks:
    - name: Configure Bashrc
      # lineinfile 모듈은 line에 정의된 내용을 기존 파일에 한 줄씩 추가하는 모듈
      lineinfile:
        path: /home/vagrant/.bashrc
        line: "{{ item }}"
      # item과 with_items는 반복적으로 실행되는 명령을 리스트 형태로 선언
      with_items:
        - "alias ans='ansible'"
        - "alias anp='ansible-playbook'"


    - name: Add "/etc/ansible/hosts"
      # blockinfile 모듈은 블록 내에 정의된 내용을 파일 형태로 저장하는 모듈
      # hosts 파일에 한글 주석이 들어가면 간혹 오류가 발생한다.
      blockinfile:
        path: /etc/ansible/hosts
        # ip가 연속된다면 공통.[시작:끝]으로 한번에 지정 가능
        block: |
          [nodes]
          192.168.56.11
          192.168.56.12
          192.168.56.13

          [k8s-master]
          192.168.56.11
          
          [k8s-workers]
          192.168.56.12
          192.168.56.13
          